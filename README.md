## ğŸš€ í”„ë¡œì íŠ¸ ë°ëª¨

í•˜ë‹¨ì˜ ë§í¬ë¥¼ ëˆ„ë¥´ë©´ ì±„íŒ… ì„œë¹„ìŠ¤ì™€ ê°œë°œì— ì‚¬ìš©ëœ ë””ìì¸ ì‹œìŠ¤í…œ ë°ëª¨ í˜ì´ì§€ë¥¼ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. :)

- **[ğŸ’¬ ì±„íŒ… ì„œë¹„ìŠ¤ ë°ëª¨](https://frontend-kavoom2-for-deploy.vercel.app/)** ë°”ë¡œê°€ê¸°
- **[ğŸ“š ë””ìì¸ ì‹œìŠ¤í…œ](https://frontend-kavoom2-for-deploy-design-system.vercel.app/)** ë°”ë¡œê°€ê¸°

## ğŸ ì‹¤í–‰ ë°©ë²•

### ê°œë°œ í™˜ê²½ ì„¤ì •í•˜ê¸°

ì´ í”„ë¡œì íŠ¸ëŠ” ìš”êµ¬ì‚¬í•­ì— ë§ì¶”ì–´ `Node.js "^14"`ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ê°œë°œí•˜ì˜€ìŠµë‹ˆë‹¤. ì´ë¥¼ `package.json`ì˜ `engines` í•„ë“œì— ëª…ì‹œí•˜ì—¬ ë°˜ë“œì‹œ í•´ë‹¹ ë²„ì „ì—ì„œë§Œ ê°œë°œ ë° ë°°í¬ê°€ ê°€ëŠ¥í•˜ë„ë¡ í–ˆìŠµë‹ˆë‹¤.

```json
{
  "engines": {
    "node": "^14"
  }
}
```

ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ì—¬ í•´ë‹¹í•˜ëŠ” ë²„ì „ì„ ì„¤ì¹˜ ë° ì‚¬ìš©í•´ ì£¼ì„¸ìš”.

```
nvm install v14
nvm use v14
```

### ì„¤ì¹˜ ë° ë©”ì¸ ì„œë¹„ìŠ¤ ì‹¤í–‰í•˜ê¸°

ì´ì œ íŒ¨í‚¤ì§€ì˜ ì˜ì¡´ì„±ì„ ì„¤ì¹˜í•˜ì—¬ ê°œë°œ í™˜ê²½ì„ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```
yarn install
yarn start
```

### ë””ìì¸ ì‹œìŠ¤í…œ ì‹¤í–‰í•˜ê¸°

ìœ„ì˜ ë‹¨ê³„ë¥¼ ë¨¼ì € ì§„í–‰í•˜ì—¬ ëª¨ë“  ì˜ì¡´ì„±ì„ ì„¤ì¹˜í–ˆë‹¤ë©´, ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ì—¬ `Storybook` ê¸°ë°˜ ë””ìì¸ ì‹œìŠ¤í…œ ê°œë°œ ì„œë²„ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```
yarn storybook
```

## ğŸ”§ ì£¼ìš” ê¸°ìˆ  ìŠ¤íƒ

ì„œë¹„ìŠ¤ ë° ê°œë°œí™˜ê²½ ì„¤ì •ì—ì„œ ì¤‘ìš”í•˜ë‹¤ê³  ìƒê°í•˜ëŠ” ìŠ¤íƒë§Œ ë‚˜ì—´í•˜ì˜€ìŠµë‹ˆë‹¤.

#### Cores

- Create React App: `react-scripts@4.0.3`
  - `react@17.0.2`
  - `react-dom@17.0.2`
- `react-router-dom`
- `zustand`
- `@tanstack/react-query`
- `sass`

`CRA`ì™€ `React`ëŠ” ê°ê° 4, 18ë²„ì „ì„ ì‚¬ìš©í•˜ê³ ì í–ˆìœ¼ë‚˜, Node 14ì™€ì˜ í˜¸í™˜ì„±ìœ¼ë¡œ ê°ê° 4, 17ë²„ì „ì„ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆ. ì´ì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì€ í•˜ë‹¨ì˜ ê³ ë ¤ì‚¬í•­ í•­ëª©ì— ê¸°ìˆ í•˜ì˜€ìŠµë‹ˆë‹¤.

ì„œë²„ ìƒíƒœë¥¼ `react-query`ì— ìœ„ì„í•˜ì—¬ ê°œë°œ ìƒì‚°ì„±ì„ ë†’ì´ê³  **[stale-while-revalidate](https://web.dev/stale-while-revalidate/)** ë°©ì‹ì— ë”°ë¼ ê°œë°œìê°€ ì „ëµì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ì— ë”°ë¼ í´ë¼ì´ì–¸íŠ¸ë‹¨ì˜ ì „ì—­ ìƒíƒœì— ëŒ€í•œ ì˜ì¡´ë„ê°€ ì¤„ì–´ë“¤ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

í´ë¼ì´ì–¸íŠ¸ë‹¨ ì „ì—­ ìƒíƒœ ê´€ë¦¬ì—ëŠ” `Redux`ì²˜ëŸ¼ Flux ë°©ì‹ìœ¼ë¡œ ì „ì—­ ìƒíƒœë¥¼ ë‹¨ë°©í–¥ ê´€ë¦¬í•  ìˆ˜ ìˆìœ¼ë©´ì„œë„, `immer` ë“± ë‹¤ë¥¸ ì¨ë“œ íŒŒí‹° ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ í†µí•©ì´ ìš©ì´í•œ `Zustand`ë¥¼ ì„ íƒí•˜ì˜€ìŠµë‹ˆë‹¤. êµ¬í˜„ ìì²´ë„ ê°„ë‹¨í•˜ê²Œ ë˜ì–´ìˆì–´ ë²ˆë“¤ ìš©ëŸ‰ë„ ì‘ìŠµë‹ˆë‹¤. :)

ìŠ¤íƒ€ì¼ì€ ì»´í¬ë„ŒíŠ¸ ë‹¨ìœ„ì˜ ëª¨ë“ˆì„ ìƒì„±í•˜ì—¬ ê¸€ë¡œë²Œ ìŠ¤ì½”í”„ì—ì„œ ìŠ¤íƒ€ì¼ ì˜¤ì—¼ì´ ë°œìƒí•˜ì§€ ì•Šë„ë¡ `SASS`ì™€ `CSS Module`ì„ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.

#### Components

- `react-textarea-autosize`
- `react-dropzone`
- `framer-motion`

í…ìŠ¤íŠ¸ ì±„íŒ… ë©”ì‹œì§€ë¥¼ ì…ë ¥í•  ë•Œ ì‚¬ìš©ìëŠ” ê°€ë…ì„±ì„ ìœ„í•´ì„œ ì¤„ë°”ê¿ˆì„ ì‚¬ìš©í•˜ì—¬ ì…ë ¥í•˜ê¸°ë„ í•©ë‹ˆë‹¤. ì±„íŒ… ì…ë ¥ í•„ë“œë„ ì¤„ë°”ê¿ˆì´ ì§€ì›ì´ ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ `react-textarea-autosize`ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.

`react-dropzone`ì€ Drag and Drop ê¸°ëŠ¥ ë¿ë§Œ ì•„ë‹ˆë¼, íŒŒì¼ í¬ê¸° ë° íƒ€ì…ì— ë”°ë¥¸ ì²˜ë¦¬ë¥¼ ìš©ì´í•˜ê²Œ í•  ìˆ˜ ìˆëŠ” APIë¥¼ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤. ì±„íŒ…ë°©ì˜ ì‚¬ì§„ ì—…ë¡œë“œ ê¸°ëŠ¥ì€ ë“œë˜ê·¸ ì•¤ ë“œë¡­ì„ ì‚¬ìš©í•˜ì§€ ì•Šì§€ë§Œ, íŒŒì¼ í¬ê¸°ì™€ íƒ€ì…ì— ë”°ë¥¸ ì˜ˆì™¸ ì²˜ë¦¬ê°€ í•„ìš”í•˜ì—¬ ì‚¬ìš©í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

#### Utilities

- `classnames`
- `date-fns`

### Design System

- `Storybook`
- `style-dictionary`

ê°œë°œ ë‹¨ì—ì„œ ì»´í¬ë„ŒíŠ¸ ë‹¨ìœ„ë¡œ ê°œë°œí•˜ë©´ì„œë„, ì´ë¥¼ ë¬¸ì„œí™”í•˜ì—¬ ì •ë¦¬í•  ìˆ˜ ìˆë„ë¡ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.

í•œí¸, `Figma`ì™€ `Zeplin` ë“± ë””ìì´ë„ˆì˜ í˜‘ì—… íˆ´ì—ì„œ ë””ìì¸ í† í°ì„ ìƒì„±í•˜ì—¬ í¸ë¦¬í•˜ê²Œ í†µí•©í•  ìˆ˜ ìˆëŠ” `style-dictionary`ë„ í•¨ê»˜ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤. ë‹¤ë§Œ ê³¼ì œì˜ ë””ìì¸ ëª…ì„¸ëŠ” íŠ¹ì • ê³„ì¸µì´ë‚˜ ê·œì¹™ì„ ê°€ì§€ê³  ë””ìì¸ í† í°ì´ ì •ì˜ê°€ ë˜ì–´ ìˆë‹¤ë³´ë‹ˆ ìš©ì´í•˜ê²Œ í™œìš©í•˜ì§€ëŠ” ëª»í–ˆìŠµë‹ˆë‹¤.

## ğŸ“ í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ êµ¬ì¡°

```bash
ğŸ“¦ @frontend_kavoom2
â”œâ”€Â public/
â”œâ”€Â src/
â”‚Â Â â”œâ”€Â index.ts
â”‚Â Â â”œâ”€Â assets/ ## ì•„ì´ì½˜, ì´ë¯¸ì§€ ë“±ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.
â”‚Â Â â”œâ”€Â components/ ## ê³µí†µ ì»´í¬ë„ŒíŠ¸ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.
â”‚Â Â â”œâ”€Â layouts/ ## ë ˆì´ì•„ì›ƒ ìš”ì†Œë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.
â”‚Â Â â”œâ”€Â hooks/ ## ê³µí†µ í›…ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.
â”‚Â Â â”œâ”€Â pages/ ## í˜ì´ì§€ë¥¼ ë Œë”ë§í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.
â”‚Â Â â”œâ”€Â routes/ ## react-router-domì˜ ë¼ìš°íŒ… ìš”ì†Œë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.
â”‚Â Â â”œâ”€Â styles/ ## SASS ì „ì—­ ìŠ¤íƒ€ì¼ ë° ê³µí†µ ë³€ìˆ˜ì™€ ìœ í‹¸ í•¨ìˆ˜ ë“±ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.
â”‚Â Â â”œâ”€Â utils/ ## ê³µí†µ ìœ í‹¸ í•¨ìˆ˜ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.
â”‚Â Â â”œâ”€Â features ## ê¸°ëŠ¥ ë‹¨ìœ„ë¡œ ëª¨ë“ˆì„ ë¶„ë¦¬í•˜ì—¬ í•˜ìœ„ ë””ë ‰í† ë¦¬ë¡œ ê´€ë¦¬í•©ë‹ˆë‹¤.
â”‚Â Â â”‚Â Â â””â”€Â {featureModuleName}
â”‚Â Â â”‚Â Â Â Â Â â”œâ”€Â index.ts ## í•´ë‹¹ ê¸°ëŠ¥ì—ì„œ ì‚¬ìš©í•˜ëŠ” ëª¨ë“ˆì€ index.tsì—ì„œ Named exportí•©ë‹ˆë‹¤.
â”‚Â Â â”‚Â Â Â Â Â â”œâ”€Â components/
â”‚Â Â â”‚Â Â Â Â Â â”œâ”€Â hooks/
â”‚Â Â â”‚Â Â Â Â Â â”œâ”€Â stores/
â”‚Â Â â”‚Â Â Â Â Â â””â”€Â queries/
â”‚Â Â â””â”€Â mockers/ ## ì±„íŒ… API Mocker
â”œâ”€Â .storybook ## ë””ìì¸ ì‹œìŠ¤í…œ Storybookì˜ ì„¤ì • êµ¬ì„±
â”œâ”€Â style-dictionary ## ë””ìì¸ í† ê·¼ ìƒì„±ì— í•„ìš”í•œ json íŒŒì¼
â”œâ”€Â package.json
â””â”€Â yarn.lock
```

## ğŸ§° ì£¼ìš” ê¸°ëŠ¥

#### ë©”ì¸ ì„œë¹„ìŠ¤ - ì±„íŒ… ëª©ë¡(/list)

- ì‚¬ìš©ìì˜ ì±„íŒ… ëª©ë¡ì„ ì¡°íšŒí•©ë‹ˆë‹¤.
- íŠ¹ì • ì±„íŒ…ë°©ì„ í´ë¦­í•˜ë©´ í•´ë‹¹í•˜ëŠ” ì±„íŒ… ë°©ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.
- í•´ë‹¹ ì±„íŒ…ë°©ì—ì„œ ë§ˆì§€ë§‰ìœ¼ë¡œ ë³´ë‚¸ ë©”ì‹œì§€ë¥¼ ë¯¸ë¦¬ë³´ê¸°ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.
- í•´ë‹¹ ì±„íŒ…ë°©ì—ì„œ ë§ˆì§€ë§‰ìœ¼ë¡œ ë©”ì‹œì§€ë¥¼ ë³´ë‚¸ ì‹œê°„ì„ í‘œì‹œí•©ë‹ˆë‹¤.
  - ì¼ì£¼ì¼ ì „ê¹Œì§€ ìƒëŒ€ì ì¸ í¬ë§·ìœ¼ë¡œ í‘œì‹œí•©ë‹ˆë‹¤. (ex. 2ì¼ ì „)
  - ê·¸ ì´ì „ì— í•´ë‹¹í•˜ëŠ” ê²½ìš° yyyyë…„ Mì›” dì¼ì˜ í¬ë§·ìœ¼ë¡œ í‘œì‹œí•©ë‹ˆë‹¤. (ex. 2000ë…„ 1ì›” 11ì¼)

#### ë©”ì¸ ì„œë¹„ìŠ¤ - ì±„íŒ…ë°©(/room/:roomId)

- í•´ë‹¹ ì±„íŒ…ë°©ì˜ ì±„íŒ… ëª©ë¡ì„ ì¡°íšŒí•©ë‹ˆë‹¤.
- ìƒë‹¨ ë°”ë¥¼ í†µí•´ ì‚¬ì§„ ë©”ì‹œì§€ë§Œ ë³¼ ìˆ˜ ìˆëŠ” ê°¤ëŸ¬ë¦¬ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.
- ë©”ì‹œì§€ë¥¼ ì „ì†¡í–ˆì„ ë•Œ ì‚¬ìš©ìê°€ ì „ì†¡ ì—¬ë¶€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë„ë¡ ìŠ¤í¬ë¡¤ì„ ìµœí•˜ë‹¨ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.
- ë©”ì‹œì§€ ì „ì†¡ ì‹œ ì „ì†¡ ìƒíƒœë¥¼ í™•ì¸í•  ìˆ˜ ìˆë„ë¡ ë¡œë”© ìƒíƒœë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.
- ì „ì†¡ ì¤‘ì¸ ë©”ì‹œì§€ë¥¼ í•´ë‹¹ ì±„íŒ…ë°©ì„ ë‚˜ê°”ë‹¤ê°€ ë‹¤ì‹œ ë“¤ì–´ì™€ë„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### ë””ìì¸ ì‹œìŠ¤í…œ

- Common, Layout, Features ì»´í¬ë„ŒíŠ¸ë¥¼ ê°œë°œ ë° í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## â„¹ï¸ ê³ ë ¤ ì‚¬í•­

#### 1. Node ë²„ì „ ì œì•½ì— ë”°ë¥¸ ì´ˆê¸° ê°œë°œ í™˜ê²½ êµ¬ì„±

ì´ˆê¸° ê°œë°œ í™˜ê²½ ì„¤ì •ì—ì„œ `react-scripts@5`ê³¼ `react/react-dom@18`ìœ¼ë¡œ êµ¬ì„±í•˜ì—¬ ì§„í–‰í•˜ê³ ì í•˜ì˜€ìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ê°œë°œ ê´€ë ¨ ë„êµ¬ì™€ í†µí•©í•˜ëŠ” ê³¼ì •ì—ì„œ `react-scripts`ì—ì„œ ì‚¬ìš©í•˜ëŠ” `Webpack 5`ì˜ ì¼ë¶€ ê¸°ëŠ¥ë“¤ì´ `Node 14`ì—ì„œëŠ” ì§€ì›í•˜ì§€ ì•ŠëŠ” ì´ìŠˆê°€ ìˆì—ˆìŠµë‹ˆë‹¤.

í•´ë‹¹ ê¸°ëŠ¥ì— ëŒ€í•œ Polyfill ì ìš©ì„ ê³ ë ¤í•´ë³´ì•˜ìœ¼ë‚˜, ì •í•´ì§„ ê¸°í•œ ë‚´ì— ê°œë°œí•´ì•¼ í•˜ëŠ” ìš”êµ¬ì‚¬í•­ê³¼ ë”ë¶ˆì–´ ì¶”í›„ì— ë°œìƒí•  ìˆ˜ ìˆëŠ” ì´ìŠˆë¥¼ ìµœì†Œí™”í•˜ê³ ì `react-scripts`ì™€ `react/react-dom`ì„ ê°ê° `4.0.3`ê³¼ `17.0.2`ìœ¼ë¡œ ë‹¤ìš´ê·¸ë ˆì´ë“œ í•˜ì˜€ìŠµë‹ˆë‹¤.

#### 2. ì„œë¹„ìŠ¤ì˜ í™•ì¥ì„±ì„ ê³ ë ¤í•œ ë””ë ‰í† ë¦¬ êµ¬ì¡° ì„¤ì •

í˜„ì—…ì—ì„œëŠ” Component, Hooks ë“±ì˜ ëª¨ë“ˆì„ `í˜ì´ì§€(pages)` ë‹¨ìœ„ë¡œ ë‚˜ëˆ„ì–´ ê´€ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤. ì´ëŠ” ëª¨ë“ˆì´ í˜ì´ì§€ì— ì˜ì¡´ì ì´ë„ë¡ ë§Œë“­ë‹ˆë‹¤. í”„ë¡œì íŠ¸ ê·œëª¨ê°€ ì»¤ì§€ë©´ì„œ ë‹¤ë¥¸ í˜ì´ì§€ì—ì„œë„ ì‚¬ìš©ë˜ëŠ” ë¹ˆë„ê°€ ë§ì´ì¡Œê³  ì´ëŠ” ê°œë°œìë¡œ í•˜ì—¬ê¸ˆ í˜¼ë™ì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë”°ë¼ì„œ ì´ë²ˆ ê³¼ì œì—ì„œëŠ” `í˜ì´ì§€(pages)`ê°€ ì•„ë‹Œ `ê¸°ëŠ¥(features)` ë‹¨ìœ„ë¡œ ëª¨ë“ˆì„ ë¶„ë¦¬í•˜ê³ ì í•˜ì˜€ìŠµë‹ˆë‹¤. í”„ë¡œì íŠ¸ ê·œëª¨ê°€ ì»¤ì ¸ê°ì— ë”°ë¼, ë³„ë„ì˜ ëª¨ë“ˆë¡œ ë¶„ë¦¬í•´ì•¼ í•˜ëŠ” ìƒí™©ì— ìœ ì—°í•˜ê²Œ ëŒ€ì‘í•  ìˆ˜ ìˆë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤. `@/features`ì˜ í•˜ìœ„ ë””ë ‰í† ë¦¬ ë‹¨ìœ„ë¡œ ë¶„ë¦¬í•˜ëŠ” ê²ƒìœ¼ë¡œ ê°€ì •í•˜ê³  ì§„í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ë©´, ì±„íŒ… ê¸°ëŠ¥ì„ ê´€ë¦¬í•˜ëŠ” `@/features/userChat`ì˜ êµ¬ì¡°ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

```bash
@/features/
â””â”€â”€ userChat/
    â”œâ”€â”€ index.ts
    â”œâ”€â”€ components/
    â”œâ”€â”€ hooks/
    â”œâ”€â”€ queries/
    â””â”€â”€ stores/
```

ê¸°ëŠ¥ ë‹¨ìœ„ì˜ í´ë”ì—ì„œ í•´ë‹¹ ê¸°ëŠ¥ê³¼ ê´€ë ¨ì´ ìˆëŠ” ì»´í¬ë„ŒíŠ¸, ì¿¼ë¦¬ í›…, ì „ì—­ ìƒíƒœ í›… ë“±ì„ ê´€ë¦¬í•˜ê²Œ ë©ë‹ˆë‹¤.
ê·¸ë¦¬ê³  `index.ts`ì—ì„œ ì‹¤ì œ ì‚¬ìš©í•˜ëŠ” ëª¨ë“ˆë§Œ `Named Export`í•˜ì—¬ ì‚¬ìš©ìëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©í•˜ê²Œ ë©ë‹ˆë‹¤.

```ts
// @feature/userChat/index.ts
// ì™¸ë¶€ì—ì„œ ì‚¬ìš©í•  ëª¨ë“ˆë§Œ exportí•©ë‹ˆë‹¤.

// Components
export { default as ChatImageMessageBox } from "./components/ChatImageMessageBox";
export { default as ChatTextMessageBox } from "./components/ChatTextMessageBox";

// Hooks
export { default as useClientSideChat } from "./hooks/useClientSideChat";
export { default as useGetChatRoomInfo } from "./hooks/useGetChatRoomInfo";

// Queries
export { default as getChatRoomInfoQuery } from "./queries/getChatRoomInfo";
```

```ts
// @pages/UserChatList.tsx
// ì±„íŒ… ëª¨ë“ˆì„ ë‹¤ìŒê³¼ ê°™ì´ ë¶ˆëŸ¬ì™€ ì‚¬ìš©í•˜ê²Œ ë©ë‹ˆë‹¤.

import {
  ChatImageMessageBox,
  ChatTextMessageBox,
  useClientSideChat,
  useGetChatRoomInfo,
} from "@/features/userChat";

const MyPage = () => {
  // ...
};
```

ê·¸ë¦¬ê³  `í˜ì´ì§€(pages)`ëŠ” ì‹¤ì§ˆì ìœ¼ë¡œ ê¸°ëŠ¥ ë‹¨ìœ„ì˜ ëª¨ë“ˆì„ ì¡°ë¦½í•˜ì—¬ í•´ë‹¹ í˜ì´ì§€ í™”ë©´ê³¼ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ë§Œì„ êµ¬ì„±í•˜ë„ë¡ êµ¬ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.

#### 3. ì „ì†¡ ì¤‘ì¸ ë©”ì‹œì§€ì˜ ìƒíƒœ ê´€ë¦¬

ì¼ë°˜ì ìœ¼ë¡œ ë¡œê·¸ì¸ í™”ë©´ì˜ í¼ê³¼ ê°™ì´ í˜ì´ì§€ ë‹¨ìœ„ì—ì„œ ë‹¨ë°œì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ìƒíƒœëŠ” í˜ì´ì§€ ì»´í¬ë„ŒíŠ¸ì—ì„œ ê´€ë¦¬í•˜ê²Œ ë©ë‹ˆë‹¤. ì´ ê²½ìš°, í˜ì´ì§€ë¥¼ ë²—ì–´ë‚œ ì´í›„ í¼ì˜ ì´ˆê¸°í™” ë“± ë³µì¡í•œ ì‹œë‚˜ë¦¬ì˜¤ì— ëŒ€í•œ ë³„ë„ì˜ ì²˜ë¦¬ ì—†ì´ í¼ì˜ ìƒíƒœ ê´€ë¦¬ê°€ í›¨ì”¬ ê°„ë‹¨í•´ì§‘ë‹ˆë‹¤.

ì±„íŒ…ë°©ì—ì„œ ì‚¬ìš©ìê°€ ë³´ë‚¸ ì „ì†¡ ëŒ€ê¸°ì¤‘ì¸ ìƒíƒœì˜ ë©”ì‹œì§€ë“¤ë„ ë¹„ìŠ·í•´ ë³´ì´ì§€ë§Œ í° ì°¨ì´ê°€ ìˆìŠµë‹ˆë‹¤. ì‚¬ìš©ìëŠ” ì—¬ëŸ¬ ì±„íŒ…ë°©ì„ ììœ ë¡­ê²Œ ë“œë‚˜ë“¤ ìˆ˜ ìˆê³ , ë‹¤ì‹œ ë“¤ì–´ì˜¨ ì´í›„ì—ë„ ì´ì „ì— ë³´ë‚¸ ë©”ì‹œì§€ì˜ ì „ì†¡ ìƒíƒœë¥¼ í™•ì¸í•  ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.

ë”°ë¼ì„œ ì‚¬ìš©ìê°€ ì „ì†¡ì¤‘ì¸ ë©”ì‹œì§€ë¥¼ í™”ë©´ì— í‘œì‹œí•  ìˆ˜ ìˆë„ë¡ `zustand` ê¸°ë°˜ ì „ì—­ ìƒíƒœë¡œ ê´€ë¦¬í•˜ë©´ì„œ, ì„œë²„ì™€ì˜ ìš”ì²­/ì‘ë‹µì„ ì²˜ë¦¬í•˜ëŠ” `react-query`ë¡œ êµ¬í˜„í•œ ì»¤ìŠ¤í…€ í›…ê³¼ í†µí•©í•˜ì—¬ UIê°€ ìì—°ìŠ¤ëŸ½ê²Œ ì „í™˜ë  ìˆ˜ ìˆë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤.

```ts
// @features/userChat/stores/useClientsideChatStore.ts
// í´ë¼ì´ì–¸íŠ¸ ë‹¨ì˜ ì „ì†¡ ì¤‘ì¸ ì‚¬ì§„ì„ ê´€ë¦¬í•˜ëŠ” ì „ì—­ ìƒíƒœ í›…ì…ë‹ˆë‹¤.

export type ClientSideChatRoom = {
  lastMessageRequsetedAt: number | null;
  messages: (PendingTextMessage | PendingImageMessage)[];
};

export interface ClientsideChatStore {
  roomMap: {
    [roomId: string]: ClientSideChatRoom;
  };
  initClientChatRoom: (roomId: string) => void;
  addPendingTextMessage: (roomId: string, message: PendingTextMessage) => void;
  addPendingImageMessage: (
    roomId: string,
    message: PendingImageMessage,
  ) => void;
  removePendingTextMessage: (roomId: string, callId: string) => void;
  removePendingImageMessage: (roomId: string, callId: string) => void;
  destroyClientChatRoom: (roomId: string) => void;
}
```

```ts
// @features/userChat/hooks/useSendChatTextMessage.ts
// í´ë¼ì´ì–¸íŠ¸ ë‹¨ì˜ ì „ì†¡ ì¤‘ì¸ ì‚¬ì§„ì„ ê´€ë¦¬í•˜ëŠ” ì „ì—­ ìƒíƒœ í›…ì…ë‹ˆë‹¤.

const mutation = useMutation(
  sendChatTextMessageQuery.queryKey(),
  sendChatTextMessageQuery.queryFn(roomId, sender),
  {
    onMutate: (variables) => {
      //...

      // ë©”ì‹œì§€ë¥¼ ì „ì†¡í•  ë•Œ í´ë¼ì´ì–¸íŠ¸ë‹¨ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
      addPendingTextMessage(roomId, {
        type: "text",
        text: variables.text,
        callId: variables.callId,
      });
    },

    onSettled: (_data, _error, variables) => {
      // onError, onSuccess ì´í›„ í•´ë‹¹ ë©”ì‹œì§€ë¥¼ ì œê±°í•©ë‹ˆë‹¤. (ì¬ì „ì†¡ ê¸°ëŠ¥ì€ ê³ ë ¤í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.)
      removePendingTextMessage(roomId, variables.callId);
    },
  },
);
```

#### 4. ì±„íŒ…ë°©ì—ì„œ ì‚¬ì§„ ì „ì†¡ ì¤‘ [Cumulative Layout Shift](https://web.dev/optimize-cls/) ì´ìŠˆ ëŒ€ì‘

ì‚¬ìš©ìê°€ í…ìŠ¤íŠ¸ ë˜ëŠ” ì‚¬ì§„ì„ ì „ì†¡í•˜ë©´ í•´ë‹¹ ì±„íŒ…ë°©ì˜ ìµœí•˜ë‹¨ìœ¼ë¡œ ìŠ¤í¬ë¡¤ì´ ì´ë™í•˜ë„ë¡ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.

ì´ ë•Œ, ì‚¬ì§„ì„ ì „ì†¡í•˜ë©´ ìµœí•˜ë‹¨ì—ì„œ ì•½ê°„ ìœ„ë¡œ ì´ë™í•˜ëŠ” ì´ìŠˆê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.

ì´ëŠ” í˜„ì¬ ë°˜ì‘í˜• ë ˆì´ì•„ì›ƒì„ ì œê³µí•´ì•¼ í•˜ëŠ” ì–´í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ë¬¸ì œì…ë‹ˆë‹¤. widthì™€ height ì†ì„±ì„ ë°˜ì‘í˜•ì„ ê³ ë ¤í•˜ì—¬ ë‹¤ìŒê³¼ ê°™ì´ ì ìš©ì„ í•˜ê³¤ í•©ë‹ˆë‹¤.

```css
img {
  width: 100%;
  height: auto;
}
```

í•˜ì§€ë§Œ, ì´ëŸ¬í•œ ë°©ì‹ì€ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œê°€ ì™„ë£Œë˜ê³  ë¸Œë¼ìš°ì €ê°€ í¬ê¸°ë¥¼ ê²°ì •í•  ìˆ˜ ìˆì„ ë•Œì—ë§Œ í•´ë‹¹ ìš”ì†Œì— ëŒ€í•œ ê³µê°„ì„ í• ë‹¹í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤. ê·¸ ì´ì „ê¹Œì§€ëŠ” ì‚¬ì‹¤ìƒ ë¹ˆ ê³µê°„ìœ¼ë¡œ ë°°ì¹˜ë©ë‹ˆë‹¤.

ë‹¤ì‹œ ëŒì•„ì™€ì„œ ì‚¬ì§„ì„ ì „ì†¡í•˜ê³  ìŠ¤í¬ë¡¤ì„ í™”ë©´ í•˜ë‹¨ìœ¼ë¡œ ì´ë™í•˜ë ¤ê³  í–ˆì„ ë•Œ, ìŠ¤í¬ë¡¤ ìš”ì†Œì˜ `scrollHeight`ì—ëŠ” ì „ì†¡í•œ ì‚¬ì§„ ë©”ì‹œì§€ì˜ ë†’ì´ê°€ í¬í•¨ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ìµœí•˜ë‹¨ì—ì„œ ì•½ê°„ ìœ„ë¡œ ì´ë™í•˜ëŠ” ë“¯í•œ í˜„ìƒì´ ë°œìƒí•œ ê²ƒì´ì—ˆìŠµë‹ˆë‹¤.

ë”°ë¼ì„œ í´ë¼ì´ì–¸íŠ¸ ë‹¨ì—ì„œëŠ” ì „ì†¡ ì¤‘ì¸ ì‚¬ì§„ì€ ì‚¬ì „ì— `width`, `height`ê°’ì„ ë¶ˆëŸ¬ì™€ì„œ ì „ì—­ ìƒíƒœì— í•¨ê»˜ ì €ì¥í•˜ê³ , ì‘ë‹µì„ ë°›ì€ ì´í›„ì—ëŠ” ì‘ë‹µì— í¬í•¨ëœ `width`, `height` ê°’ì„ ì‚¬ìš©í•˜ë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤.

```ts
// @features/userChat/hooks/useSendChatImageMessage.ts
const mutation = useMutation(
  sendChatImageMessageQuery.queryKey(),
  sendChatImageMessageQuery.queryFn(roomId, sender),
  {
    onMutate: async (variables) => {
      queryClient.cancelQueries(getChatRoomMessagesQuery.queryKey(roomId));

      // ì‚¬ì§„ íŒŒì¼ì˜ ObjectURLì„ ìƒì„±í•˜ì—¬ width, height ê°’ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
      const filePath = URL.createObjectURL(variables.file);
      const sizes = await getImageOriginalSize(filePath);

      // ì´ë¥¼ í´ë¼ì´ì–¸íŠ¸ì˜ ì±„íŒ… ê´€ë ¨ ì „ì—­ ìƒíƒœì— í•¨ê»˜ ì €ì¥í•©ë‹ˆë‹¤.
      addPendingImageMessage(roomId, {
        type: "image",
        callId: variables.callId,
        filePath,
        width: sizes?.width || 0,
        height: sizes?.height || 0,
      });
    },
  },
);
```

## ê°œì„ í•´ì•¼í•  ì 
